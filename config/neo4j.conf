# Neo4j Configuration for 1GB RAM e2-micro VM
# Optimized for Neo4j Community Edition on Google Cloud Platform

#*****************************************************************
# Memory Settings - Optimized for 1GB RAM VM
#*****************************************************************

# Initial heap size
server.memory.heap.initial_size=256m

# Maximum heap size
server.memory.heap.max_size=512m

# Page cache size for caching graph data
server.memory.pagecache.size=256m

#*****************************************************************
# Network Settings
#*****************************************************************

# Default database
server.default_database=neo4j

# Listen on all interfaces
server.default_listen_address=0.0.0.0

# HTTP connector
server.http.enabled=true
server.http.listen_address=0.0.0.0:7474

# HTTPS connector (disabled to save resources)
server.https.enabled=false

# Bolt connector
server.bolt.enabled=true
server.bolt.listen_address=0.0.0.0:7687

#*****************************************************************
# Database Settings
#*****************************************************************

# Transaction timeout
server.db.transaction.timeout=30s

# Lock acquisition timeout
server.db.lock.acquisition.timeout=20s

# Query timeout
server.db.query.timeout=60s

# Enable query logging
server.db.logs.query.enabled=INFO
server.db.logs.query.threshold=1s

#*****************************************************************
# Security Settings
#*****************************************************************

# Authentication and authorization
server.security.auth_enabled=true

# Disable procedures that are not needed for small deployments
server.security.procedures.unrestricted=apoc.export.*,apoc.import.*,apoc.refactor.*,apoc.create.*,apoc.merge.*

#*****************************************************************
# Performance Settings for Small VM
#*****************************************************************

# Reduce parallelism for small CPU
server.db.query.parallel.enabled=false

# Optimize for small datasets
server.db.store.files.preallocate=false

# Reduce memory overhead
server.db.memory.transaction.global_max_size=128m
server.db.memory.transaction.max_size=32m

# Limit concurrent transactions
server.db.transaction.concurrent.maximum=100

#*****************************************************************
# Logging Configuration
#*****************************************************************

# Log levels
server.logs.user.level=INFO
server.logs.security.level=INFO

# Log file settings
server.logs.user.rotation.keep_number=5
server.logs.user.rotation.size=10m

# Debug logging (disable in production)
server.logs.debug.level=WARN

#*****************************************************************
# Backup and Maintenance
#*****************************************************************

# Checkpoint settings
server.db.checkpoint.interval.time=5m
server.db.checkpoint.interval.tx=1000

# Index sampling
server.db.index.sampling.sample_size_limit=1000000

#*****************************************************************
# Connection Pool Settings
#*****************************************************************

# Bolt connection pool
server.bolt.connection_keep_alive=true
server.bolt.connection_keep_alive_for_requests=ALL

# HTTP connection settings
server.http.connection_timeout=30s
server.http.request_timeout=30s

#*****************************************************************
# Cypher Settings
#*****************************************************************

# Cypher runtime
cypher.default_runtime=interpreted

# Disable expensive operations for small VM
cypher.hints.error=false
cypher.lenient_create_relationship=false

#*****************************************************************
# Storage Settings
#*****************************************************************

# Store settings for small datasets
server.db.store.files.buffer_size=8192

# Reduce I/O operations
server.db.store.files.flush_policy=batch

#*****************************************************************
# Monitoring and Metrics
#*****************************************************************

# Enable metrics
server.metrics.enabled=true
server.metrics.jvm.enabled=true
server.metrics.system.enabled=true

# Metrics reporting interval
server.metrics.csv.interval=30s

#*****************************************************************
# Deprecated Settings (for reference)
#*****************************************************************

# These settings are deprecated but may appear in older configurations
# dbms.memory.heap.initial_size=256m
# dbms.memory.heap.max_size=512m
# dbms.memory.pagecache.size=256m